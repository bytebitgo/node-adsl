# é¡¹ç›®èƒŒæ™¯

---

> ç”±äºå›½å†…å„ç§å‚å•†é™æœ¬å¢æ•ˆï¼Œå¯¹æˆæœ¬çš„è¿›ä¸€æ­¥å‹ç¼©ï¼Œæ‰€ä»¥è¢«è¿«ä¸€äº›å…¬å¸ä»ä¸“çº¿ åˆ° ä¼ ç»ŸIDC å†åˆ°åŸåŸŸç½‘ ç”šè‡³åˆ°ç°åœ¨çš„ADSL æ‹¨å·æ±‡èšï¼Œä»¥åŠä¸€äº›å¤§å‚æ— ä¸‹é™çš„P2Pã€‚
> 
> æœ¬é¡¹ç›®ä¸ºADSLæ‹¨å·æ±‡èšè€Œç”Ÿï¼ˆä¸å¼€æºï¼Œæ— æˆæƒï¼Œä½†å…è´¹ï¼Œè¯·æ”¾å¿ƒä½¿ç”¨ï¼‰

>åç»­ä¼šæŒç»­æ›´æ–°æ–°åŠŸèƒ½å’Œä¿®å¤bug ï¼Œä¼šå®šæœŸåŒæ­¥ä¸‹è½½åœ°å€ã€‚

>å‚¬æ›´è”ç³» bytebit@foxmail.com

### åŠŸèƒ½ç‰¹æ€§

- [x] æ”¯æŒCento7 ,Centos8ç³»ç»Ÿè¿è¡Œ,å…¶ä»–ç³»ç»Ÿå¯æ‰©å±•æ”¯æŒ

- [x] å¯ä»¥ç»‘å®šæ‹¨å·çš„ç½‘å¡

- [x] æ”¯æŒæ‹¨å·çš„ç½‘ç»œç±»å‹

     - 1. æ‰€æœ‰æ‹¨å·è´¦å·éƒ½åœ¨ä¸€ä¸ª vlan, é…ç½®æ–‡ä»¶ä¾‹å­ ![user.txt](https://raw.githubusercontent.com/bytebitgo/node-adsl/main/user.txt_novlanid "new")


     - 2. æ¯ä¸ªæ‹¨å·è´¦å·å¯¹åº”ä¸€ä¸ª vlan, é…ç½®æ–‡ä»¶ä¾‹å­ ![user.txt](https://raw.githubusercontent.com/bytebitgo/node-adsl/main/user.txt_vlanid "new1")


     - 3. åŒä¸€ä¸ªvlanä¸‹ï¼Œå¯¹åº”ä¸åŒæˆ–ç›¸åŒæ‹¨å·è´¦æˆ·çš„å¤šæ‹¨ï¼ˆè¿è¥å•†ä¸é™åˆ¶æƒ…å†µä¸‹ï¼‰ é…ç½®æ–‡ä»¶ä¾‹å­ ![user.txt](https://raw.githubusercontent.com/bytebitgo/node-adsl/main/user.txt_vlanid_equal "new2")


- [x] æ”¯æŒMacVlanæ–¹å¼ä¸‹ï¼ŒMACç¬¬ä¸€æ¬¡éšæœºç”Ÿæˆåï¼Œé’ˆå¯¹æ¯ä¸€ä¸ªæ‹¨å·è´¦æˆ·å›ºå®šï¼ˆé˜²ISPå°ç¦è´¦æˆ·ï¼‰

- [x] æ”¯æŒå¤šçº¿è·¯çš„è´Ÿè½½å‡è¡¡

- [x] æ”¯æŒæ‰çº¿ä¹‹åå†æ‹¨å·,ç§’çº§å®Œæˆ

- [x] æ”¯æŒå•ç‹¬ç®¡ç†åœ°å€ç½‘å¡é…ç½®

- [x] ç®€å•æ–¹ä¾¿å¿«æ·;

### éƒ¨ç½²æ¶æ„å›¾


<details>
<summary><strong>ç‚¹å¼€æŸ¥çœ‹æ¶æ„å›¾ï¼Œå›¾ä¸€ä¸ºæœ¬ç¨‹åºï¼Œå›¾äºŒä¸ºikuai</strong></summary>

![æœ¬ç¨‹åºæ¶æ„å›¾](https://raw.githubusercontent.com/bytebitgo/node-adsl/main/img/new.jpeg "new")

</details>


# æœ€è¿‘æ›´æ–°

- ğŸš€ æ”¯æŒé‡å¤ç”¨æˆ·(ä¸€ä¸ªè´¦æˆ· å¤šæ‹¨ï¼Œè¿è¥å•†ä¸é™åˆ¶æƒ…å†µä¸‹)  Wed, 23 Feb 2022 09:34:42 +0800

- ğŸš€ å¢åŠ æ–°æ¨¡å¼ macvlanMix Tue, 22 Feb 2022 21:22:04 +0800

- ğŸš€ vlanæ“ä½œé€»è¾‘æ›´æ”¹ Mon, 29 Nov 2021 10:05:48 +0800
  

- ğŸ›ç½‘å…³ipæ·»åŠ ç­–ç•¥æ›´æ”¹ Wed, 24 Nov 2021 17:22:12 +0800
  

- ğŸŒŸmac éšæœºåä¸‰ä¸ªbyte Mon, 22 Nov 2021 10:34:53 +0800
  

- ğŸ›æ·»åŠ vlanå‰,å…ˆåˆ é™¤Wed, 10 Nov 2021 14:50:36 +0800ğŸš€å›ºå®šmacaddr bug fix Wed, 10 Nov 2021 14:27:29 +0800

- ğŸŒŸå›ºå®šmacadrr, å›å†™åˆ°user.config Tue, 19 Oct 2021 10:49:40 +0800
  

- ğŸŒŸæ”¯æŒvlan æ¨¡å¼  Mon, 18 Oct 2021 17:31:57 +0800
  

- ğŸš€ping ä¹‹å‰å®æ—¶è·å–å¯¹åº”çš„ip&gate Tue, 31 Aug 2021 15:14:21 +0800
  

- ğŸ›log error bug  Tue, 31 Aug 2021 14:54:59 +0800
  

- ğŸš€ä¸»åŠ¨pingç½‘å…³  Tue, 31 Aug 2021 14:21:37 +0800
  

- ğŸ›pid æŸ¥æ‰¾bug  Thu, 26 Aug 2021 14:40:45 +0800
  

- ğŸš€1.å¤šä¸ªé»˜è®¤ç½‘å…³é—®é¢˜ 2.æ”¹å Fri, 28 May 2021 10:17:54 +0800

### å®‰è£…ä¸é…ç½®

# Centos7ç³»ç»Ÿ

```shell
yum -y install rp-pppoe ppp
```

# Centos7åˆå§‹åŒ–è„šæœ¬

```shell
curl -s curl -s https://mirrors.xiangyundns.cn/init/ppp/el7-ppp.sh 2>/dev/null|bash -
```

# Centos8ç³»ç»Ÿ

```shell
yum -y install NetworkManager-ppp ppp
```

# Centos8åˆå§‹åŒ–è„šæœ¬

```shell
curl -s https://mirrors.xiangyundns.cn/init/ppp/el8-ppp.sh 2>/dev/null|bash -
```

# é…ç½®ä»£ç†,æ–¹ä¾¿è¿œç¨‹ç›®æ ‡è®¾å¤‡

```shell
curl -s https://mirrors.xiangyundns.cn/init/frp/inst-frp.sh|bash
```

#### ä¿®æ”¹ /etc/frp/frpc.ini

- é…ç½®ä¿®æ”¹ frpc.ini å†…å®¹(***å…³äºfrpçš„ä½¿ç”¨ï¼Œä¸åœ¨è¿™é‡Œè®²ï¼Œè‡ªè¡Œbaidu***)
  
  

remote_port å­—æ®µ(å¿…é¡»ä½¿ç”¨æœªä½¿ç”¨çš„ç«¯å£)

## é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š

```ini
[ctc-ly-1011-SSH]

type = tcp

local_ip = 127.0.0.1

local_port = 22

remote_port = 7195

use_encryption = true

use_compression = true

[ctc-ly-1011-SNMP]

type = udp

local_ip = 127.0.0.1

local_port = 161

remote_port = 7196

use_encryption = false

use_compression = false
```

## é‡å¯ frpc

```shell
systemctl restart frpc
```

# å®‰è£… pppmgt

```shell
rpm -ivh https://mirrors.xiangyundns.cn/init/ppp/pppmgt-1.0.0-15.el8-x86_64.rpm
```



### ~~ä¸»é…ç½®æ–‡ä»¶: /etc/pppmgt/config.yaml~~

```yaml
eths: [eno1] # æ‹¨å·ç»‘å®šçš„ç½‘å¡

net_type: vlan # é€‰æ‹© macvlan æˆ– vlan

mgtnet: # ç®¡ç†ç½‘å¡é…ç½®ï¼Œå¦‚æœé…ç½®äº†ï¼Œåˆ™ åŠ å…¥ç­–ç•¥è·¯ç”±ï¼Œä»é»˜è®¤ç½‘å…³ä¸­ç§»é™¤

ip: '192.168.100.219'

gate_ip: '192.168.100.1'

eth: 'eno3'

bind_ip: ['112.27.240.52','218.15.40.171']
```

# è´¦å·å¯†ç æ–‡ä»¶: /etc/pppmgt/user.txt

#### `user password vlanid`

#### (vlanæ¨¡å¼ä¸‹å¿…é¡»,macvlan æ¨¡å¼ä¸‹ä½¿ç”¨ä¸­æ¨ªçº¿ä»£æ›¿"-") MacAddress(ç¨‹åºä¼šè‡ªåŠ¨å¡«å†™,æ— é¡»æ‰‹åŠ¨å¡«å†™)**

#### <mark>user password vlanid</mark>(vlanæ¨¡å¼ä¸‹å¿…é¡») `mac_addr`

```textile
637132896453 888888 201

637132896231 888888 202

637132770236 888888 203
```

-  å¯é€‰é…ç½®

### å°†ç®¡ç†ç½‘å¡çš„é…ç½®æ–‡ä»¶æ‰‹åŠ¨æ”¹æˆé™æ€åœ°å€é…ç½®,æ— é»˜è®¤ç½‘å…³

```shell
/etc/sysconfig/network-scripts/ifcfg-eno3

TYPE="Ethernet"

BOOTPROTO="static"

DEFROUTE="yes"

IPV6INIT="no"

IPV6_AUTOCONF="yes"

IPV6_DEFROUTE="yes"

NAME="eno3â€

DEVICE="eno3â€

ONBOOT="yes"

IPADDR="192.168.100.56"

NETMASK="255.255.255.0"

DNS1="119.29.29.29"

DNS2="223.5.5.5"
```



# å¯åŠ¨ pppmgt è¿›ç¨‹

```shell
systemctl start pppmgt
```

# æ£€æŸ¥ ppp åœ°å€æ•°é‡æ˜¯å¦ç¬¦åˆè¦æ±‚

```shell
ip add list|grep "scope global ppp"|wc -l
```

# pppmgtæ•…éšœç›¸å…³é—®é¢˜æ’æŸ¥

```shell
cat /var/log/pppmgt/ppp.log
```



# ppp æ‹¨å·é—®é¢˜æ’æŸ¥

```shell
cat /var/log/ppp/pppoe-ppp0.log

......

cat /var/log/ppp/pppoe-pppN.log
```